---
title: "An introduction to the Generic Mapping Tools"
date: 2013-04-24
categories: geography
tags: cartography
---

GMT is the go-to cartography tool when you need to draw high-quality maps.  Many people are too content to generate maps using ArcGIS or other proprietary software, not knowing the less resource-hunger and more flexible GMT.

## Origin

The Generic Mapping Tools, or GMT, is originally developed by Paul Wessel and Walter H. F. Smith in 1988, when they were graduate students at Lamont-Doherty Earth Observatory.

## Why GMT?

There are a plethora of GIS software that supports somewhat WYSIWYG map making.  The user can select the area, overlay various data and map elements, and finally generate a map in a number of formats.  In many circumstances, people may find such an approach straight and easy.  However, imagine that you have to frequently make maps that are similar, or use data that are contantly changing, processing the data and placing symbols by pointing and clicking soon becomes very tedious, if not impossible.

Such scenario is where the command-line based GMT shines.  As a collection of tools, GMT can be invoked just like other *nix commands to complete complex operations.  The actions are often written in a shell script along with other commands outside the GMT toolbox that preprocess data, prettify outputs, and generate reports, etc.  If the data changed, one only needs to re-run the script to get the updated graphics.  If the map specification changed, often one just need to change a few arguments.  It is even possible to generate maps on the fly with parameters entered by the user on a web interface.  GMT to GUI-based cartography tools is like ImageMagick to Photoshop -- some tasks are best done in the terminal.

## What defines a map

In GMT a map has these essential elements:

Data domain or map region
:    the area the map includes.  Often specified by the `-R` argument.

Map projection/Coordinate transformation
:    how the spheric surface of the Earth is shown on the map and how are geographic coordinates translated to geometric coordinates in the image.  GMT supports most major projections, as the chart shows:

:    ![GMT supported projections](https://dl.dropboxusercontent.com/s/g5df0yrizqnl9jt/GMT_-J.png)

Basemap
:    the map on which shapes and symbols are placed.  Also include elements such as frames, ticks, etc.

Overlays
:    used to stack features and symbols on the previous layer of `postscript` map.

And of course, data.

## Data

### Input

When drawing maps, there are mainly 3 types of data for GMT to process: binary data, ASCII data, and netCDF data.  Thanks to the `-J` option, in most cases GMT knows where to put each data point, but occasionally one may need to use `-fi` option to set the input format.

The binary data must be float point numbers, stored in a format that GMT recognizes.  The argument `-bi` prepares a GMT tool for reading binary data.  One can append an `s` to indicate that the data is of single precision.  An integer following `-bi` indicates the number of columns in the binary file.

Although readable to human, ASCII data have too many different conventions and formats for GMT to read correctly.  Some preprocessing may be needed to transform the data into a form similar to that used by the `-R` argument, i.e. coordinates written as decimal degrees: `-157.24039` or the `[Â±]ddd[:mm[:ss[.xxx]]][W|E|S|N]` format: `157:14:25.404E`.  Thanks to a horde of text editors and tools on various platforms, this shouldn't be too difficult.  GMT can also deal with headers and files that have irregular column arrangements[^gmt4-10].

[NetCDF](http://www.unidata.ucar.edu/software/netcdf/) format is commonly used by the science community to create, store, and share array-based data.   As input, GMT reads netCDF tabular data, which is basically a table comprising several 1-dimensional columns, with metadata describing each column.  Thanks to the metadata, reading netCDF is even easier than reading ASCII tables in GMT.  one can use the `-bic` argument to specify which variables (columns) are to read.

### Where can I get data sets?

* Boundaries, coast lines, rivers etc.: the GMT command `pscoast` provides reasonably good data.  According to its `man` page:

       > The  coastline  database  is  GSHHS which is compiled from two sources: World Vector Shorelines (WVS) and CIA World Data Bank II  (WDBII).  In particular, all level-1 polygons (ocean-land boundary) are derived from the more accurate WVS while all higher level polygons (level 2-4,  representing  land/lake,  lake/island-in-lake, and island-in-lake/lake-in-island-in-lake boundaries) are taken from WDBII.

       Further information on data processing can be found in [Appendix K](http://gmt.soest.hawaii.edu/gmt/html/GMT_Docs.html#x1-223000K) of the GMT Technical Reference and Cookbook.

* Thematic data: there are a number of repositories of geographical data sets in NetCDF format, e.g. [BADC](http://badc.nerc.ac.uk/data/dataset_index/?source=data), and there are a few collections made by researchers and organizations promoting free GIS and data, just google "geographical data sets" and you will find a lot.

### Output

Most of the tools of GMT writes PostScript files.  A few of them generate netCDF files.  Both are quite open formats that can be manipulated in a lot of ways.  By changing the defaults, GMT can also generate encapsulated PS (EPS) files that is more suitable for publishing.

Many commands also supports numerical outputs in binary or ASCII formats.

## Recipes

### A simple map of your country

Only `pscoast` `pstext` and `psxy` are needed for this.  I am from China, so let's use it for example:

~~~~ {.bash}
#!/bin/bash

# Draw a map of China

ps=simplemap.ps # output file
pscoast -R70/0/145/55r -Ja105/27/1:40000000 -I1 -N1/thick,blue -W,blue -K -B10g10 > $ps
            # -R: China geographical span is from 73E-135E, 4N-53N
            # -J: use Lambert Azimuthal Equal-Area projection, with the central meridian
                            # at 105E, and a scale of 1:10M
            # -I: draw major rivers with default pen
            # -N: draw boundaries, note there are some disputing borders;
                            # specify thick pen and dash-dot pattern
            # -W: draw shorelines
            # -K: leave the output file "open" so more features can be appended
            # -B: set map boundary annotation and tick mark intervals
pstext -R70/0/145/55r -Ja105/27/1:40000000 -O -K -G0 << END >> $ps
95 35 25 0 1 LM C H I N A
END
psxy -J -R -O -m -Wthick,blue << END >> $ps
   >
   121.0,20.5
   120.0,19.5
   >
   119.3,17.0
   119.2,15.5
   >
   119.0,12.7
   118.0,11.0
   >
   117.0,8.5
   116.0,7.0
   >
   114.9,6.0
   114.0,5.5
   >
   112.4,4.1
   111.5,4.0
   >
   109.7,4.5
   108.5,6.1
   >
   109.2,9.0
   110.3,10.5
   >
   110.3,14.2
   109.5,16.0
   >
   108.0,18.0
   108.5,19.8
END
            # -O: select overlay plot mode, so we don't have to input -R and -J
                            # specs again.
            # -m: multi-segment line mode
            # This is only for illustrating the use of psxy.
            # The lines are after this map: http://bit.ly/ZR4u9y
            # I have no coordinates for each segment's start and end point
            # so the data is not accurate.
            # Don't use if you are dealing with actual map making.
~~~~

The result:

![](https://dl.dropboxusercontent.com/s/9lx35kovt62fezq/simplemap.png)

### A contour map

Contour maps are most often used for describing elevation data.  Therefore, this example will also use elevation data.  The data is downloaded using ETOPO1 (ice) dataset provided by the [NOAA National Geophysical Data Center](http://maps.ngdc.noaa.gov/viewers/wcs-client/).  I select an area whose bottom-left corner is 6W, 52N and top-right 0E, 56N[^1].

~~~~
#!/bin/bash

# Draw a contour map of the UK and Ireland's topography.

topo=etopo1_bedrock.grd
ps=contour.ps

pscoast -R-6/52/0/56r \
-Ju30/1:2500000 -P -B2 -Gwhite -Sp36/40 -W -K > $ps
    # -G: Specify the color used for filling the "dry" areas
    # -S: Fill pattern for "wet" areas.
grdcontour $topo -C150 -O -R \
    -Ju30/1:2500000 -L0/9999 -P >> $ps
    # -C: The contour interval.  The larger the number,
        # the fewer lines you will see.
~~~~

Result: ![](https://dl.dropboxusercontent.com/s/4rlwvdsquihetn9/contour.png?token_hash=AAFTQw6minkzNcpHInjyYeX4nffrnO88PRz7L18QypzikQ)

### A heat map

A heat map is somewhat like contour map, it uses colours to visualize intensity, temperature, frequency, etc. and their spatial distribution.  What's better to illustrate a heat map than a map of topography again?[^2]

~~~~
#/bin/bash
# prepare the surface
# data downloaded from ftp://topex.ucsd.edu/pub/global_topo_1min/
#img2grd ~/images/global_topo_1min/topo_11.1.img -T1 -S1 -R70/105/25/40 -m1 -D -Gtopo.nc -V
#mv topo.nc ~/Documents/2009/thesis/auxillary/topo.nc
# land is a home-made cpt derived from GMT_relief.cpt
makecpt -Cland -T-1000/9000/1000 -Z -V > topo.cpt
# Relieves
grdgradient ~/Documents/2009/thesis/auxillary/topo.nc -Ne1 -A100 -M -Glight.nc
#basemap
grdimage ~/Documents/2009/thesis/auxillary/topo.nc -Ilight.nc -Ctopo.cpt -Jm87.5/32.5/0.6c -Bpa600mg600m -R70/105/25/40 -K > ~/Documents/2009/thesis/images/topography.ps
pscoast -Bpa600mg600mf300m -J -R -I2 -N1/thick -W -L77/27/33/1000 -Tf102/37/1.5c -O -K >> ~/Documents/2009/thesis/images/topography.ps
psxy ~/Documents/2009/thesis/auxillary/boundary.xy -O -J -R -Sc0.03c -Gblack -K >> ~/Documents/2009/thesis/images/topography.ps
# annotations
pstext -O -J -R -K >> ~/Documents/2009/thesis/images/topography.ps <<END
75 29 18 0 1 LM @#India@%%
80 39 16 0 21 LM XUAR
84 33 16 0 21 LM TAR
93 37 16 0 21 LM Qinghai
100 30 16 0 21 LM Sichuan
END
pstext -O -J -R -Wwhite,Othinnest,white -K >> ~/Documents/2009/thesis/images/topography.ps <<END
88 37 14 0 5 LM [1]
92 33 14 0 5 LM [2]
89 30 14 0 5 LM [3]
100 29 14 0 5 LM [4]
END
# [1]: Kunlung Mt.
# [2]: Tangula Mt.
# [3]: Niangqen-Tanglha Mt.
# [4]: Hengduan Mt.
# making and drawing contours
grdcontour ~/Documents/2009/thesis/auxillary/topo.nc -Jm87.5/32.5/0.6c -Q10000 -L-1000/9000 -C500 -O -K >> ~/Documents/2009/thesis/images/topography.ps
psscale -D19c/4.5c/5c/1c -Ctopo.cpt -B2000:@Topography: -O >> ~/Documents/2009/thesis/images/topography.ps
~~~~

Result: ![](https://dl.dropboxusercontent.com/s/u2qagsqyyw8tjdb/topography.png?token_hash=AAEh5OcitPlQqj7uxDdGXyBohikHBokiLDZYAsYyafdTVQ)

### Not only maps

It is possible to use GMT for plotting many kinds of data.  However, I recommend not to use it in all occasions unless it is the only plotting tool you know[^3].  If you are really inclined, see [here](http://gmt.soest.hawaii.edu/gmt/html/GMT_Docs.html#x1-1480007.21) alone with a lot of useful examples.

## Using the graphics

Images generated by GMT are PostScript files.  The reason is obvious: so the multitude of GMT tools can build on the result of the previous command.  If you are a PostScript guru, you can even edit the file with notepad.exe.  But when we need to incorporate the image in our work, we usually need to turn the .ps into another format.

There are many GUI based tools that can read PostScript files, for example, Preview.app that comes with Mac OS X.  You can open the file in such tools, crop the file, and export it to another format.  But this somehow beats the purpose of using command-line tools -- to automate things.  If you use EPS files in your work, you only have to change the default settings of GMT:

~~~~
$ gmtdefaults -D
#
#       GMT-SYSTEM 4.5.9 [64-bit] Defaults file
#
#-------- Plot Media Parameters -------------
PAGE_COLOR              = white
PAGE_ORIENTATION        = landscape
PAPER_MEDIA             = a4
[...]
~~~~

`PAPER_MEDIA` is what you need to change.  You just need to add an "+" after whatever paper type you need to use.

~~~~
$ gmtset PAPER_MEDIA a4+
~~~~

If you want to output PDF, there are tools such as `ps2pdf`.

If you want to output raster files in PNG or other usual image formats, see `ps2raster`.  For example, the command you will likely most often use is

~~~~
$ ps2raster psfile.ps -A -Tg
~~~~

[^gmt4-10]: 4.10 "Input data formats". GMT Technical Reference and Cookbook. <http://gmt.soest.hawaii.edu/gmt/html/GMT_Docs.html#x1-690004.10>

[^1]: Part of UK.
[^2]: Being lazy, I used a map I made for my PhD dissertation back in 2009.

    Haoyang Xu. *Resilience in Tibetan Pastoral System in Modernisation*. PhD Thesis. University of Nottingham. 2009.
[^3]: Really? You don't know about MS Excel, R, SPSS but you know GMT?
